# Codebase Structure

**Analysis Date:** 2026-01-18

## Directory Layout

```
makerblocks/
├── makerblocks.php          # Plugin entry point
├── inc/                     # PHP modules
├── src/
│   ├── scripts/             # React source → assets/js/
│   ├── blocks-dev/          # Block source → blocks/
│   ├── components/          # Shared React components
│   ├── lib/                 # Utilities (api, utils)
│   ├── styles/              # Sass 7-1 structure
│   ├── types/               # TypeScript definitions
│   └── test/                # Test setup
├── blocks/                  # Compiled blocks (wp-scripts output)
├── assets/
│   ├── js/                  # Compiled scripts
│   ├── css/                 # Compiled styles
│   └── admin/               # Admin scripts
└── .planning/codebase/      # This documentation
```

## Directory Purposes

**inc/**
- Purpose: PHP modules loaded by plugin
- Contains: `blocks.php`, `enqueue_assets.php`, `wp_localize.php`, `helpers.php`
- Key files: All loaded via foreach in `makerblocks.php`
- Subdirectories: `safelist-classes/` (Tailwind PurgeCSS allowlist)

**src/scripts/**
- Purpose: React application source
- Contains: Entry point, hydration engine, SPA app
- Key files: `index.ts`, `MakerBlocks.tsx`
- Subdirectories: `apps/makerstarter/` (pages, layouts, components)

**src/blocks-dev/**
- Purpose: Gutenberg block source (5-file pattern each)
- Contains: `app/`, `header/`, `_template/`
- Key files per block: `block.json`, `index.js`, `edit.js`, `render.php`, `*.tsx`

**src/components/ui/**
- Purpose: ShadCN UI primitives
- Contains: 10 styled Radix components
- Key files: `button.tsx`, `card.tsx`, `dialog.tsx`, `tabs.tsx`

**src/lib/**
- Purpose: Shared utilities
- Contains: `api.ts` (REST client), `utils.ts` (cn function)

**src/styles/**
- Purpose: Sass 7-1 architecture
- Subdirectories: `abstracts/`, `base/`, `components/`, `layout/`, `pages/`, `vendors/`
- Key files: `styles.scss` (entry point)

**src/types/**
- Purpose: TypeScript type definitions
- Key files: `global.d.ts`, `api.d.ts`, `wordpress.d.ts`

## Key File Locations

**Entry Points:**
- `makerblocks.php` - Plugin bootstrap
- `src/scripts/index.ts` - Frontend JS entry
- `src/blocks-dev/*/index.js` - Block registration

**Configuration:**
- `tsconfig.json` - TypeScript (ES2020, @/* alias)
- `vitest.config.ts` - Testing
- `package.json` - Scripts and deps
- `components.json` - ShadCN config

**Core Logic:**
- `src/scripts/MakerBlocks.tsx` - Hydration engine
- `src/lib/api.ts` - REST client
- `inc/blocks.php` - Block registration
- `inc/wp_localize.php` - Data injection

**Testing:**
- `src/test/setup.ts` - Vitest setup with mocks

## Naming Conventions

**Files:**
- React components: PascalCase (`Header.tsx`, `Button.tsx`)
- Utilities: kebab-case (`api.ts`, `utils.ts`)
- PHP: snake_case (`enqueue_assets.php`)
- Tests: `*.test.ts` pattern (none exist yet)

**Directories:**
- kebab-case: `blocks-dev`, `safelist-classes`
- Singular for type: `scripts`, `lib`, `test`
- Plural for collections: `pages`, `components`, `layouts`

**Special Patterns:**
- `_template/` - Block scaffold template (underscore prefix)
- `*.d.ts` - Type declarations
- `block.json` - Block metadata (WordPress standard)

## Where to Add New Code

**New Block:**
1. Create folder: `src/blocks-dev/<block-name>/`
2. Add 5 files: `block.json`, `index.js`, `edit.js`, `<Name>.tsx`, `render.php`
3. Register in `inc/blocks.php`
4. Add to `MakerBlocks.tsx` componentRegistry

**New Page (SPA):**
1. Create: `src/scripts/apps/makerstarter/pages/<Name>.tsx`
2. Add route in `MakerStarter.tsx`

**New UI Component:**
1. Create: `src/components/ui/<name>.tsx`
2. Follow ShadCN pattern (CVA + forwardRef)

**New Utility:**
1. Add to: `src/lib/<name>.ts`
2. Or extend existing `api.ts` / `utils.ts`

**New Type:**
1. Add to: `src/types/<scope>.d.ts`
2. Or create new `<name>.d.ts`

## Special Directories

**blocks/**
- Purpose: Compiled block output
- Source: Auto-generated by wp-scripts from `src/blocks-dev/`
- Committed: Yes (WordPress needs compiled blocks)

**assets/js/, assets/css/**
- Purpose: Compiled frontend assets
- Source: Built from `src/scripts/`, `src/styles/`
- Committed: Yes

**node_modules/**
- Purpose: npm dependencies
- Committed: No (in .gitignore)

---

*Structure analysis: 2026-01-18*
*Update when directory structure changes*
